# iFlow 项目上下文

## 项目概览

这是一个用 Go 语言编写的库项目，旨在提供各种通用功能模块，方便在其他 Go 项目中复用。项目模块化程度高，每个子目录通常代表一个独立的功能模块。

主要功能模块包括：
*   **缓存 (cache)**: 提供缓存相关功能，包括 LRU 缓存和 Redis 缓存的封装。
*   **编解码 (codec)**: 提供常见的编解码功能，如 AES 加密、Base32/64 编码、GZIP 压缩、SHA 哈希等。
*   **IP 地址处理 (ip)**: 提供 IP 地址相关的处理功能。
*   **地图 SDK (mapsdk)**: 对百度、高德、腾讯等地图服务 API 进行封装，提供统一的接口。
*   **重试机制 (retry)**: 提供通用的重试逻辑实现。
*   **系统工具 (sys)**: 提供系统相关的工具函数，如 panic 处理、信号处理等。
*   **类型扩展 (typing)**: 提供一些扩展的数据结构和类型定义，如链表、树、对象池、响应实体等。
*   **HTTP 客户端 (xhttp)**: 对标准库 `net/http` 进行封装，提供更易用的 HTTP 客户端功能。
*   **日志 (xlog)**: 对 `go.uber.org/zap` 进行封装，提供结构化日志记录功能。
*   **限流器 (xrate)**: 提供限流功能。

项目依赖了多个第三方库，如 `go.uber.org/zap` 用于日志，`github.com/redis/go-redis/v9` 用于 Redis 客户端等。

## 构建和运行

这是一个 Go 库项目，本身不包含可执行的 `main` 函数。它需要被其他 Go 项目引用才能使用。

要使用此库，需要在你的 Go 项目中执行以下命令：

```bash
go get github.com/monaco-io/lib
```

然后在代码中导入需要的包即可使用，例如：

```go
import "github.com/monaco-io/lib/xlog"
```

### 测试

项目中包含了大量的单元测试文件（以 `_test.go` 结尾）。可以通过以下命令运行所有测试：

```bash
go test ./...
```

也可以运行特定模块的测试，例如：

```bash
go test ./xlog/...
```

## 开发约定

*   **模块化**: 代码按功能模块组织，每个模块通常有一个主包文件（如 `xlog.go`）和相关的实现文件、测试文件。
*   **接口设计**: 对于像 `mapsdk` 这样的模块，使用接口 (`ISDK`) 来定义统一的行为，方便扩展和替换具体实现。
*   **错误处理**: 使用自定义的错误类型（如 `typing/xec.Error`）来表示特定的错误码和消息。
*   **日志记录**: 使用 `xlog` 包进行结构化日志记录。
*   **HTTP 客户端**: 使用 `xhttp` 包进行 HTTP 请求，它提供了链路追踪等高级功能。
*   **配置管理**: 通过函数选项模式 (`xopt.Option`) 来传递和管理配置。